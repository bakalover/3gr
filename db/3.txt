1) select Н_ТИПЫ_ВЕДОМОСТЕЙ.НАИМЕНОВАНИЕ, Н_ВЕДОМОСТИ.ЧЛВК_ИД from Н_ТИПЫ_ВЕДОМОСТЕЙ 
left outer join Н_ВЕДОМОСТИ ON Н_ТИПЫ_ВЕДОМОСТЕЙ.ИД = Н_ВЕДОМОСТИ.ТВ_ИД
where Н_ТИПЫ_ВЕДОМОСТЕЙ.ИД > 2 and Н_ВЕДОМОСТИ.ДАТА = '2022-06-08' and Н_ВЕДОМОСТИ.ДАТА = '1998-01-05';

2) select Н_ЛЮДИ.ФАМИЛИЯ, Н_ОБУЧЕНИЯ.НЗК, Н_УЧЕНИКИ.ГРУППА from Н_ЛЮДИ 
right join Н_ОБУЧЕНИЯ ON Н_ЛЮДИ.ИД = Н_ОБУЧЕНИЯ.ЧЛВК_ИД 
right join Н_УЧЕНИКИ on Н_ОБУЧЕНИЯ.ЧЛВК_ИД = Н_УЧЕНИКИ.ЧЛВК_ИД 
where Н_ЛЮДИ.ФАМИЛИЯ = 'Иванов' and Н_ОБУЧЕНИЯ.НЗК = '001000';

3) select ФАМИЛИЯ from Н_ЛЮДИ group by ФАМИЛИЯ;

4) select Н_ГРУППЫ_ПЛАНОВ.ПЛАН_ИД from Н_ГРУППЫ_ПЛАНОВ 
join Н_ПЛАНЫ on Н_ГРУППЫ_ПЛАНОВ.ПЛАН_ИД = Н_ПЛАНЫ.ИД where Н_ПЛАНЫ.ФО_ИД = 1 group by Н_ГРУППЫ_ПЛАНОВ.ПЛАН_ИД having count(Н_ГРУППЫ_ПЛАНОВ.ГРУППА) > 2;

5) SELECT Н_УЧЕНИКИ.ГРУППА as Группа, 
	AVG(CASE WHEN NOW() < Н_ЛЮДИ.ДАТА_СМЕРТИ THEN AGE(NOW(),Н_ЛЮДИ.ДАТА_РОЖДЕНИЯ) 
	ELSE AGE(Н_ЛЮДИ.ДАТА_СМЕРТИ,Н_ЛЮДИ.ДАТА_РОЖДЕНИЯ) END) as Средний_возраст FROM Н_УЧЕНИКИ 
JOIN Н_ЛЮДИ ON Н_УЧЕНИКИ.ЧЛВК_ИД = Н_ЛЮДИ.ИД 
GROUP BY Н_УЧЕНИКИ.ГРУППА
HAVING AVG(CASE WHEN NOW() < Н_ЛЮДИ.ДАТА_СМЕРТИ THEN AGE(NOW(),Н_ЛЮДИ.ДАТА_РОЖДЕНИЯ) ELSE AGE(Н_ЛЮДИ.ДАТА_СМЕРТИ,Н_ЛЮДИ.ДАТА_РОЖДЕНИЯ) END) > (SELECT MIN(CASE WHEN NOW() < Н_ЛЮДИ.ДАТА_СМЕРТИ THEN AGE(NOW(),Н_ЛЮДИ.ДАТА_РОЖДЕНИЯ) ELSE AGE(Н_ЛЮДИ.ДАТА_СМЕРТИ,Н_ЛЮДИ.ДАТА_РОЖДЕНИЯ) END) FROM Н_УЧЕНИКИ JOIN Н_ЛЮДИ ON Н_УЧЕНИКИ.ЧЛВК_ИД = Н_ЛЮДИ.ИД WHERE Н_УЧЕНИКИ.ГРУППА = '1100')
ORDER BY Средний_возраст;

6)  SELECT ГРУППА, ФАМИЛИЯ, ИМЯ, ОТЧЕСТВО, НОМЕР, СОСТОЯНИЕ FROM Н_УЧЕНИКИ 
JOIN Н_ЛЮДИ ON Н_УЧЕНИКИ.ЧЛВК_ИД = Н_ЛЮДИ.ИД 
JOIN Н_ПЛАНЫ ON Н_УЧЕНИКИ.ПЛАН_ИД = Н_ПЛАНЫ.ИД 
WHERE НАЧАЛО = '2012-09-01' AND КУРС = 1;

7.1) SELECT Н_ОТДЕЛЫ.ИД WHERE Н_ОТДЕЛЫ.КОРОТКОЕ_ИМЯ = 'КТиУ'; Предзапрос
7.2) SELECT ФАМИЛИЯ, ИМЯ  FROM  Н_ЛЮДИ WHERE ИД IN (
SELECT Н_УЧЕНИКИ.ЧЛВК_ИД FROM Н_УЧЕНИКИ
JOIN Н_ПЛАНЫ ON Н_УЧЕНИКИ.ПЛАН_ИД = Н_ПЛАНЫ.ИД
JOIN Н_ВЕДОМОСТИ USING(ЧЛВК_ИД)
join Н_ЛЮДИ on Н_ЛЮДИ.ИД = Н_УЧЕНИКИ.ЧЛВК_ИД
WHERE Н_ПЛАНЫ.ОТД_ИД = 703
GROUP BY Н_УЧЕНИКИ.ЧЛВК_ИД HAVING COUNT(*) = 
SUM(CASE WHEN Н_ВЕДОМОСТИ.ОЦЕНКА = '4' THEN 1 WHEN Н_ВЕДОМОСТИ.ОЦЕНКА = '5' THEN 1  WHEN Н_ВЕДОМОСТИ.ОЦЕНКА = 'зачёт' THEN 1 ELSE 0 END) AND 
SUM(CASE WHEN Н_ВЕДОМОСТИ.ОЦЕНКА = '4' THEN 1 ELSE 0 END) >= 1);

